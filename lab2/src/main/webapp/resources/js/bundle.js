(()=>{"use strict";class t{constructor(){this.xInput=null,this.yInput=null,this.canvas=null,this.form=null,this.initializeElements()}initializeElements(){this.xInput=document.getElementById("coordinate-x"),this.yInput=document.getElementById("coordinate-y"),this.canvas=document.getElementById("area-canvas"),this.form=document.getElementById("coordinates-form")}getFormValues(){var t,e;return{x:(null===(t=this.xInput)||void 0===t?void 0:t.value.trim())||"",y:(null===(e=this.yInput)||void 0===e?void 0:e.value.trim())||"",r:this.getSelectedRadius()}}getForm(){return this.form}getSelectedRadius(){const t=document.querySelector('input[name="radius"]:checked');return t?parseFloat(t.value):null}addFormSubmitListener(t){var e;null===(e=this.form)||void 0===e||e.addEventListener("submit",t)}addYInputListener(t){var e;null===(e=this.yInput)||void 0===e||e.addEventListener("input",t)}addXChangeListener(t){var e;null===(e=this.xInput)||void 0===e||e.addEventListener("change",t)}addRadiusChangeListener(t){document.querySelectorAll('input[name="radius"]').forEach(e=>{e.addEventListener("change",t)})}getXInput(){return this.xInput}getYInput(){return this.yInput}setRadiusValue(t){const e=document.querySelector(`input[name="radius"][value="${t}"]`);e&&(e.checked=!0)}}class e{showError(t,e){const r=document.getElementById(t);r?(r.textContent=e,r.style.color="red",r.style.fontSize="small",r.style.display="block",setTimeout(()=>{this.hideError(t)},5e3)):console.warn(`Элемент с ID '${t}' не найден на странице`)}hideError(t){const e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}hideAllErrors(){["error-x","error-y","error-r"].forEach(t=>this.hideError(t))}}class r{validateX(t){return t.trim()?{isValid:!0}:{isValid:!1,errorMessage:"Please, select X coordinate"}}validateY(t){if(!t.trim())return{isValid:!1,errorMessage:"Please, enter the Y coordinate"};const e=parseFloat(t);return isNaN(e)?{isValid:!1,errorMessage:"Y coordinate must be number"}:e<-3||e>3?{isValid:!1,errorMessage:"Y coordinate must be greater than -3 and less than 3"}:{isValid:!0}}validateR(t){return null===t?{isValid:!1,errorMessage:"Please, select Radius"}:{isValid:!0}}validateAllFields(t,e,r){return[{result:this.validateX(t),errorId:"error-x"},{result:this.validateY(e),errorId:"error-y"},{result:this.validateR(r),errorId:"error-r"}]}}class s{constructor(t){this.canvas=null,this.ctx=null,this.points=[],this.currentR=null,this.CANVAS_WIDTH=400,this.CANVAS_HEIGHT=600,this.CENTER_X=200,this.CENTER_Y=300,this.GRAPH_SIZE=320,this.MAX_R=3,this.initializeCanvas(t)}initializeCanvas(t){this.canvas=document.getElementById("area-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.setupEventListeners(t))}setupEventListeners(t){var e;null===(e=this.canvas)||void 0===e||e.addEventListener("click",e=>this.handleCanvasClick(e,t))}setCurrentR(t){this.currentR=t,this.redrawPoints()}getRandomColor(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}handleCanvasClick(t,e){if(!this.canvas||!this.currentR)return void(this.currentR||e.showError("error-r","Please select radius R first!"));const r=this.canvas.getBoundingClientRect(),s=this.GRAPH_SIZE/(2*this.MAX_R),i=t.clientX-r.left,n=t.clientY-r.top,a=(i-this.CENTER_X)/s,l=(this.CENTER_Y-n)/s;console.log("handle canvas click",a,l),this.submitPointToServer(a,l,this.currentR)}submitPointToServer(t,e,r){const s=document.createElement("form");s.method="post",s.action="controller",s.style.display="none";const i=document.createElement("input");i.type="hidden",i.name="x",i.value=parseFloat(t.toFixed(2)).toString(),s.appendChild(i);const n=document.createElement("input");n.type="hidden",n.name="y",n.value=parseFloat(e.toFixed(2)).toString(),s.appendChild(n);const a=document.createElement("input");a.type="hidden",a.name="radius",a.value=r.toString(),s.appendChild(a),document.body.appendChild(s),s.submit()}drawPoint(t,e,r){if(!this.ctx||!this.currentR)return;const s=this.GRAPH_SIZE/(2*this.MAX_R),i=this.CENTER_X+t*s,n=this.CENTER_Y-e*s;console.log("draw point",t,e,r),this.ctx.beginPath(),this.ctx.arc(i,n,4,0,2*Math.PI),this.ctx.fillStyle=this.getRandomColor(),this.ctx.fill(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,this.ctx.stroke()}clearPoints(){this.points=[],this.ctx&&this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT)}redrawPoints(){this.ctx&&(this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.points.forEach(t=>{this.currentR&&this.drawPoint(t.x,t.y,t.hit||!1)}))}addResultPoint(t,e,r){const s={x:t,y:e,hit:r};console.log("pointToAdd",s),this.points.push(s),this.currentR&&this.drawPoint(s.x,s.y,r),console.log("points",this.points)}}class i{constructor(){this.domHandler=new t,this.errorHandler=new e,this.validator=new r,this.canvasHandler=new s(this.errorHandler),this.initializeEventListeners(),this.initializeResultPoints()}handleRadiusChange(){const t=this.domHandler.getSelectedRadius();this.canvasHandler.setCurrentR(t)}initializeResultPoints(){document.querySelectorAll(".result-row").forEach(t=>{const e=t.querySelectorAll(".result-cell");if(e.length>=4){const t=parseFloat(e[0].textContent||""),r=parseFloat(e[1].textContent||""),s=parseFloat(e[2].textContent||""),i="Yes"===e[3].textContent;isNaN(t)||isNaN(r)||isNaN(s)||this.canvasHandler.addResultPoint(t,r,i)}});const t=document.querySelector(".result-row");if(t){const e=t.querySelector(".result-cell:nth-child(3)");if(e){const t=parseFloat(e.textContent||"");isNaN(t)||(this.domHandler.setRadiusValue(t),this.canvasHandler.setCurrentR(t))}}}initializeEventListeners(){var t;this.domHandler.addYInputListener(t=>this.handleYInput(t)),this.domHandler.addXChangeListener(()=>this.hideError("error-x")),this.domHandler.addRadiusChangeListener(()=>this.handleRadiusChange()),null===(t=this.domHandler.getForm())||void 0===t||t.reset(),this.domHandler.addFormSubmitListener(t=>this.handleFormSubmit(t))}handleFormSubmit(t){var e;t.preventDefault();const r=this.domHandler.getFormValues();console.log("formValues",r);const s=this.validator.validateAllFields(r.x,r.y,r.r);this.handleValidationResults(s)&&(null===(e=this.domHandler.getForm())||void 0===e||e.submit())}handleYInput(t){const e=t.target;e.value=e.value.replace(/[^0-9.-]/g,""),this.errorHandler.hideError("error-y")}handleValidationResults(t){return this.errorHandler.hideAllErrors(),t.every(t=>!!t.result.isValid||(this.errorHandler.showError(t.errorId,t.result.errorMessage),!1))}hideError(t){this.errorHandler.hideError(t)}}document.addEventListener("DOMContentLoaded",()=>{new i})})();
//# sourceMappingURL=bundle.js.map