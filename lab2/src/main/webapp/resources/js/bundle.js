(()=>{"use strict";class t{constructor(){this.xInput=null,this.yInput=null,this.canvas=null,this.form=null,this.initializeElements()}initializeElements(){this.xInput=document.getElementById("coordinate-x"),this.yInput=document.getElementById("coordinate-y"),this.canvas=document.getElementById("area-canvas"),this.form=document.getElementById("coordinates-form")}getFormValues(){var t,e;return{x:(null===(t=this.xInput)||void 0===t?void 0:t.value.trim())||"",y:(null===(e=this.yInput)||void 0===e?void 0:e.value.trim())||"",r:this.getSelectedRadius()}}getForm(){return this.form}getSelectedRadius(){const t=document.querySelector('input[name="radius"]:checked');return t?parseFloat(t.value):null}addFormSubmitListener(t){var e;null===(e=this.form)||void 0===e||e.addEventListener("submit",t)}addYInputListener(t){var e;null===(e=this.yInput)||void 0===e||e.addEventListener("input",t)}addXChangeListener(t){var e;null===(e=this.xInput)||void 0===e||e.addEventListener("change",t)}addRadiusChangeListener(t){document.querySelectorAll('input[name="radius"]').forEach(e=>{e.addEventListener("change",t)})}getXInput(){return this.xInput}getYInput(){return this.yInput}setRadiusValue(t){const e=document.querySelector(`input[name="radius"][value="${t}"]`);e&&(e.checked=!0)}}class e{showError(t,e){const r=document.getElementById(t);r?(r.textContent=e,r.style.color="red",r.style.fontSize="small",r.style.display="block",setTimeout(()=>{this.hideError(t)},5e3)):console.warn(`Элемент с ID '${t}' не найден на странице`)}hideError(t){const e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}hideAllErrors(){["error-x","error-y","error-r"].forEach(t=>this.hideError(t))}}class r{validateX(t){return t.trim()?{isValid:!0}:{isValid:!1,errorMessage:"Please, select X coordinate"}}validateY(t){if(!t.trim())return{isValid:!1,errorMessage:"Please, enter the Y coordinate"};const e=parseFloat(t);return isNaN(e)?{isValid:!1,errorMessage:"Y coordinate must be number"}:e<-3||e>3?{isValid:!1,errorMessage:"Y coordinate must be greater than -3 and less than 3"}:{isValid:!0}}validateR(t){return null===t?{isValid:!1,errorMessage:"Please, select Radius"}:{isValid:!0}}validateAllFields(t,e,r){return[{result:this.validateX(t),errorId:"error-x"},{result:this.validateY(e),errorId:"error-y"},{result:this.validateR(r),errorId:"error-r"}]}}class i{constructor(t){this.canvas=null,this.ctx=null,this.points=[],this.currentR=null,this.CANVAS_WIDTH=400,this.CANVAS_HEIGHT=600,this.CENTER_X=200,this.CENTER_Y=300,this.GRAPH_SIZE=320,this.MAX_R=3,this.initializeCanvas(t)}initializeCanvas(t){this.canvas=document.getElementById("area-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.setupEventListeners(t))}setupEventListeners(t){var e;null===(e=this.canvas)||void 0===e||e.addEventListener("click",e=>this.handleCanvasClick(e,t))}setCurrentR(t){this.currentR=t,this.redrawPoints()}getPointColor(t){return t.hit?"#00ff00":"#ff0000"}handleCanvasClick(t,e){if(!this.canvas||!this.currentR)return void(this.currentR||e.showError("error-r","Please select radius R first!"));const r=this.canvas.getBoundingClientRect(),i=this.GRAPH_SIZE/(2*this.MAX_R),s=t.clientX-r.left,n=t.clientY-r.top;console.log("handle canvas click",s,n);const a=(s-this.CENTER_X)/i,l=(this.CENTER_Y-n)/i;console.log("handle canvas graph",a,l),this.submitPointToServer(a,l,this.currentR)}submitPointToServer(t,e,r){const i=document.createElement("form");i.method="post",i.action="controller",i.style.display="none";const s=document.createElement("input");s.type="hidden",s.name="x",s.value=parseFloat(t.toFixed(2)).toString(),i.appendChild(s);const n=document.createElement("input");n.type="hidden",n.name="y",n.value=parseFloat(e.toFixed(2)).toString(),i.appendChild(n);const a=document.createElement("input");a.type="hidden",a.name="radius",a.value=r.toString(),i.appendChild(a),document.body.appendChild(i),i.submit()}drawPoint(t){if(!this.ctx||!this.currentR)return;const e=this.GRAPH_SIZE/(2*this.MAX_R),r=this.CENTER_X+t.x*e*t.r/this.currentR,i=this.CENTER_Y-t.y*e*t.r/this.currentR;this.ctx.beginPath(),this.ctx.arc(r,i,4,0,2*Math.PI),this.ctx.fillStyle=this.getPointColor(t),this.ctx.fill(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,this.ctx.stroke()}redrawPoints(){this.ctx&&(this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.points.forEach(t=>{this.drawPoint(t)}))}addResultPoint(t,e,r,i){const s={x:t,y:e,r,hit:i};this.points.push(s),this.currentR&&this.drawPoint(s)}}class s{constructor(){this.currentR=1,this.scale=53,this.centerX=200,this.centerY=300,this.initializeSVG()}initializeSVG(){const t=document.querySelector('input[name="radius"]:checked');t&&this.updateSVGWithR(parseFloat(t.value)),document.querySelectorAll('input[name="radius"]').forEach(t=>{t.addEventListener("change",t=>{const e=t.target;e.checked&&this.updateSVGWithR(parseFloat(e.value))})})}updateSVGWithR(t){this.currentR=t;const e=t/2*this.scale,r=t*this.scale,i=document.getElementById("rectangle");i&&(i.setAttribute("x",(this.centerX-e).toString()),i.setAttribute("y",(this.centerY-r).toString()),i.setAttribute("width",e.toString()),i.setAttribute("height",r.toString()));const s=document.getElementById("quarter-circle");if(s){const t=`M${this.centerX},${this.centerY} \n                L${this.centerX},${this.centerY-r} \n                A${r},${r} 0 0,1 ${this.centerX+r},${this.centerY} \n                L${this.centerX},${this.centerY} Z`;s.setAttribute("d",t)}const n=document.getElementById("triangle");if(n){const t=`${this.centerX},${this.centerY} \n                ${this.centerX+e},${this.centerY} \n                ${this.centerX},${this.centerY+e}`;n.setAttribute("points",t)}}setCurrentR(t){this.updateSVGWithR(t)}}class n{constructor(){this.domHandler=new t,this.errorHandler=new e,this.validator=new r,this.canvasHandler=new i(this.errorHandler),this.svgHandler=new s,this.initializeEventListeners(),this.initializeResultPoints()}handleRadiusChange(){const t=this.domHandler.getSelectedRadius();null!==t&&(this.canvasHandler.setCurrentR(t),this.svgHandler.setCurrentR(t))}initializeResultPoints(){document.querySelectorAll(".result-row").forEach(t=>{const e=t.querySelectorAll(".result-cell");if(e.length>=4){const t=parseFloat(e[0].textContent||""),r=parseFloat(e[1].textContent||""),i=parseFloat(e[2].textContent||""),s="Yes"===e[3].textContent;isNaN(t)||isNaN(r)||isNaN(i)||this.canvasHandler.addResultPoint(t,r,i,s)}});const t=document.querySelector(".result-row");if(t){const e=t.querySelector(".result-cell:nth-child(3)");if(e){const t=parseFloat(e.textContent||"");isNaN(t)||(this.domHandler.setRadiusValue(t),this.canvasHandler.setCurrentR(t),this.svgHandler.setCurrentR(t))}}}initializeEventListeners(){var t;this.domHandler.addYInputListener(t=>this.handleYInput(t)),this.domHandler.addXChangeListener(()=>this.hideError("error-x")),this.domHandler.addRadiusChangeListener(()=>this.handleRadiusChange()),null===(t=this.domHandler.getForm())||void 0===t||t.reset(),this.domHandler.addFormSubmitListener(t=>this.handleFormSubmit(t))}handleFormSubmit(t){var e;t.preventDefault();const r=this.domHandler.getFormValues(),i=this.validator.validateAllFields(r.x,r.y,r.r);this.handleValidationResults(i)&&(null===(e=this.domHandler.getForm())||void 0===e||e.submit())}handleYInput(t){const e=t.target;e.value=e.value.replace(/[^0-9.-]/g,""),this.errorHandler.hideError("error-y")}handleValidationResults(t){return this.errorHandler.hideAllErrors(),t.every(t=>!!t.result.isValid||(this.errorHandler.showError(t.errorId,t.result.errorMessage),!1))}hideError(t){this.errorHandler.hideError(t)}}document.addEventListener("DOMContentLoaded",()=>{new n})})();
//# sourceMappingURL=bundle.js.map