(()=>{"use strict";class t{constructor(){this.xInput=null,this.yInput=null,this.canvas=null,this.form=null,this.initializeElements()}initializeElements(){this.xInput=document.getElementById("coordinate-x"),this.yInput=document.getElementById("coordinate-y"),this.canvas=document.getElementById("area-canvas"),this.form=document.getElementById("coordinates-form")}getFormValues(){var t,e;return{x:(null===(t=this.xInput)||void 0===t?void 0:t.value.trim())||"",y:(null===(e=this.yInput)||void 0===e?void 0:e.value.trim())||"",r:this.getSelectedRadius()}}getForm(){return this.form}getSelectedRadius(){const t=document.querySelector('input[name="radius"]:checked');return t?parseFloat(t.value):null}addFormSubmitListener(t){var e;null===(e=this.form)||void 0===e||e.addEventListener("submit",t)}addYInputListener(t){var e;null===(e=this.yInput)||void 0===e||e.addEventListener("input",t)}addXChangeListener(t){var e;null===(e=this.xInput)||void 0===e||e.addEventListener("change",t)}addRadiusChangeListener(t){document.querySelectorAll('input[name="radius"]').forEach(e=>{e.addEventListener("change",t)})}getXInput(){return this.xInput}getYInput(){return this.yInput}setRadiusValue(t){const e=document.querySelector(`input[name="radius"][value="${t}"]`);e&&(e.checked=!0)}}class e{showError(t,e){const i=document.getElementById(t);i?(i.textContent=e,i.style.color="red",i.style.fontSize="small",i.style.display="block",setTimeout(()=>{this.hideError(t)},5e3)):console.warn(`Элемент с ID '${t}' не найден на странице`)}hideError(t){const e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}hideAllErrors(){["error-x","error-y","error-r"].forEach(t=>this.hideError(t))}}class i{validateX(t){return t.trim()?{isValid:!0}:{isValid:!1,errorMessage:"Please, select X coordinate"}}validateY(t){if(!t.trim())return{isValid:!1,errorMessage:"Please, enter the Y coordinate"};const e=parseFloat(t);return isNaN(e)?{isValid:!1,errorMessage:"Y coordinate must be number"}:e<-3||e>3?{isValid:!1,errorMessage:"Y coordinate must be greater than -3 and less than 3"}:{isValid:!0}}validateR(t){return null===t?{isValid:!1,errorMessage:"Please, select Radius"}:{isValid:!0}}validateAllFields(t,e,i){return[{result:this.validateX(t),errorId:"error-x"},{result:this.validateY(e),errorId:"error-y"},{result:this.validateR(i),errorId:"error-r"}]}}class s{constructor(){this.canvas=null,this.ctx=null,this.points=[],this.currentR=null,this.CANVAS_WIDTH=200,this.CANVAS_HEIGHT=300,this.CENTER_X=100,this.CENTER_Y=150,this.GRAPH_SIZE=160,this.MAX_R=3,this.lastClickedPoint=null,this.initializeCanvas()}initializeCanvas(){this.canvas=document.getElementById("area-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.setupEventListeners())}setupEventListeners(){var t;null===(t=this.canvas)||void 0===t||t.addEventListener("click",t=>this.handleCanvasClick(t))}setCurrentR(t){this.currentR=t,this.redrawPoints()}handleCanvasClick(t){if(!this.canvas||!this.currentR)return void(this.currentR||alert("Please select radius R first!"));const e=this.canvas.getBoundingClientRect(),i=this.GRAPH_SIZE/(2*this.MAX_R),s=t.clientX-e.left,r=t.clientY-e.top,n=(s-this.CENTER_X)/i,a=(this.CENTER_Y-r)/i;this.lastClickedPoint={x:n,y:a},this.submitPointToServer(n,a,this.currentR)}submitPointToServer(t,e,i){const s=document.getElementById("coordinates-form");if(!s)return;const r=document.getElementById("coordinate-x"),n=document.getElementById("coordinate-y");if(r&&n){const a=Array.from(r.options).map(t=>parseFloat(t.value)).filter(t=>!isNaN(t)).reduce((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e);r.value=a.toString(),n.value=e.toString();const l=document.querySelector(`input[name="radius"][value="${i}"]`);l&&(l.checked=!0),s.submit()}}drawPoint(t,e,i){if(!this.ctx||!this.currentR)return;const s=this.GRAPH_SIZE/(2*this.MAX_R),r=this.CENTER_X+t*s,n=this.CENTER_Y-e*s;this.ctx.beginPath(),this.ctx.arc(r,n,4,0,2*Math.PI),this.ctx.fillStyle=i?"#00ff00":"#ff0000",this.ctx.fill(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,this.ctx.stroke()}redrawPoints(){this.ctx&&(this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.points.forEach(t=>{this.currentR&&this.drawPoint(t.x,t.y,t.hit||!1)}))}clearPoints(){this.points=[],this.ctx&&this.ctx.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT)}addResultPoint(t,e,i){const s=this.lastClickedPoint?Object.assign(Object.assign({},this.lastClickedPoint),{hit:i}):{x:t,y:e,hit:i};this.points.push(s),this.currentR&&this.drawPoint(s.x,s.y,i),this.lastClickedPoint=null}}class r{constructor(){this.domHandler=new t,this.errorHandler=new e,this.validator=new i,this.canvasHandler=new s,this.initializeEventListeners(),this.initializeResultPoints()}handleRadiusChange(){const t=this.domHandler.getSelectedRadius();this.canvasHandler.setCurrentR(t)}initializeResultPoints(){document.querySelectorAll(".result-row").forEach(t=>{const e=t.querySelectorAll(".result-cell");if(e.length>=4){const t=parseFloat(e[0].textContent||""),i=parseFloat(e[1].textContent||""),s=parseFloat(e[2].textContent||""),r="Yes"===e[3].textContent;isNaN(t)||isNaN(i)||isNaN(s)||this.canvasHandler.addResultPoint(t,i,r)}});const t=document.querySelector(".result-row");if(t){const e=t.querySelector(".result-cell:nth-child(3)");if(e){const t=parseFloat(e.textContent||"");isNaN(t)||(this.domHandler.setRadiusValue(t),this.canvasHandler.setCurrentR(t))}}}initializeEventListeners(){this.domHandler.addFormSubmitListener(t=>this.handleFormSubmit(t)),this.domHandler.addYInputListener(t=>this.handleYInput(t)),this.domHandler.addXChangeListener(()=>this.hideError("error-x")),this.domHandler.addRadiusChangeListener(()=>this.handleRadiusChange())}handleFormSubmit(t){var e;t.preventDefault();const i=this.domHandler.getFormValues(),s=this.validator.validateAllFields(i.x,i.y,i.r);this.handleValidationResults(s)&&(null===(e=this.domHandler.getForm())||void 0===e||e.submit())}handleYInput(t){const e=t.target;e.value=e.value.replace(/[^0-9.-]/g,""),this.errorHandler.hideError("error-y")}handleValidationResults(t){return this.errorHandler.hideAllErrors(),t.every(t=>!!t.result.isValid||(this.errorHandler.showError(t.errorId,t.result.errorMessage),!1))}hideError(t){this.errorHandler.hideError(t)}}document.addEventListener("DOMContentLoaded",()=>{new r})})();
//# sourceMappingURL=bundle.js.map